# 什么是 WalletConnect？终极 WalletConnect 指南

> 原文：<https://moralis.io/what-is-walletconnect-the-ultimate-walletconnect-guide/>

如果用户想与 Web3 应用程序交互，加密钱包是必不可少的组件。此外，加密钱包充当网关，让用户访问区块链上的分散应用程序([**【dApps】**](https://moralis.io/decentralized-applications-explained-what-are-dapps/)**)，如** [**以太坊**](https://moralis.io/full-guide-what-is-ethereum/) **。不过，有大量的区块链钱包可用，如**[**meta mask**](https://moralis.io/metamask-explained-what-is-metamask/)**、Rainbow、Trust Wallet、Argent 等。，开发人员发现在实现对他们的 dApp 的这些钱包的支持时，编程过程很麻烦。因此，WalletConnect 提供了一种解决方案，使开发人员能够毫不费力地实现 dApps 和钱包之间的连接。此外，使用 Moralis，您可以将 WalletConnect 集成到您的 dApp 中，并轻松验证用户。因此，在本文中，我们将进一步了解什么是 WalletConnect，以及如何利用它和 Moralis 来认证 Web3 用户。**

使用 Moralis，您可以利用它对 WalletConnect 的本机支持。反过来，您将能够体验如何通过使用 Moralis 提供的一行代码来快速认证用户。因此，我们将在整篇文章中使用 Moralis，因为它使 dApp 用户的身份验证变得更加简单易懂。

Moralis 还提供了大量的 [Web3 开发](https://moralis.io/how-to-build-decentralized-apps-dapps-quickly-and-easily/?utm_source=blog&utm_medium=post&utm_campaign=Develop%2520Your%2520Own%2520NFT%2520Marketplace%2520%25E2%2580%2593%2520Step-by-Step%2520Guide)工具，可以帮助完成整个开发过程。例如，有了 [Moralis Speedy Nodes](https://moralis.io/speedy-nodes/) ，你将可以使用市场上最快、最可靠的区块链节点。这些节点支持以太坊、多边形、BSC(币安智能链)、Avalanche、Arbitrum 和 Fantom 等区块链。因此，Moralis 已经成为 Web3 开发的终极操作系统。

通过注册该平台，获得所有 Moralis 工具的访问权限。只需要几秒钟，你就可以马上开始你的第一个区块链项目了！

## **什么是 WalletConnect？**

对 WalletConnect 的一个误解是，它经常被称为一个应用程序；然而，事实并非如此。WalletConnect 不是一个应用程序，而是一个开源协议，用于在各种钱包和 dapp 之间建立连接。该协议在两个应用程序、钱包或设备之间建立加密连接。这个连接通过两个对等体的共享密钥进行对称加密。

![](img/a4ce26192ca70ee5d7ccfe0cc7edde1b.png)

WalletConnect 与超过 75 个领先的钱包合作，其中 MetaMask、 [Rainbow](https://rainbow.me/) 、 [Trust Wallet](https://trustwallet.com/) 和 [Argent](https://www.argent.xyz/) 是最受欢迎的钱包。钱包和 dApps 之间的联系是通过扫描二维码或深度链接建立的。代码或链接由一个对等体发出，然后由交互的另一个对等体扫描或批准。如果将 WalletConnect 集成到 dApp 中，那么创建安全可靠的连接是极其容易的。这种替代方案甚至比单独使用 MetaMask 或任何其他钱包都更安全。

WalletConnect 提供了额外的有用特性，对区块链开发非常有用。这里有几个例子:

*   **不可知链–**到目前为止，WalletConnect 支持各种不同的链。这意味着，例如，在使用以太坊或 Solana 时，可以使用 WalletConnect。此外，根据 WalletConnect 的官方网站，该协议将在未来扩展到支持更多的连锁店。
*   **多链–**除了支持几个不同的链，该协议还允许多链集成。这意味着可以将一个钱包同时连接到多个链。
*   **平台无关–**此外，WalletConnect 也是平台无关的。这意味着该协议可以跨桌面、浏览器、移动和游戏应用程序使用。

如果你想挑战加密钱包，看看 Moralis 关于如何用 4 步建立加密钱包的文章。

## 使用道德标准构建 dApps 为什么要认证用户？

例如，[以太坊 dApp 开发](https://moralis.io/how-to-build-dapps-on-ethereum/)的一个重要方面就是围绕着用户的认证。在与 dApps 互动时，允许用户验证自己的身份，让他们确信自己是钱包的主人，这一点至关重要。因此，所有的 dApp 开发者都需要在他们的项目中加入某种形式的认证机制。

市场上最大的加密钱包是 MetaMask，它在全球每月拥有超过 1000 万用户。因此，dApp 开发人员集成允许用户注册并使用 MetaMask 进行认证的功能并不罕见。然而，钱包替代品的数量正在不断增长，这使得集成另一个选项(如 WalletConnect)变得更加有利。

由于 WalletConnect 支持多种不同的钱包，您允许您的 dApp 用户使用几种不同的钱包。这意味着在对我们的 dApps 的潜在用户进行身份验证时，使用 WalletConnect 可能是有利的。

![](img/a3533079431d176e74996dad4f88b72a.png)

然而，将这种功能添加到 dApps 中可能相当麻烦，因为在许多情况下，它需要复杂的编码。这就是 Moralis 作为头号 Web3 操作系统进入市场的原因。因此，Moralis 负责处理繁重的工作，使您能够更快地创建和启动您的项目。

因此，我们将在接下来的章节中解释在使用 Moralis 时使用 WalletConnect 对用户进行[身份验证是多么容易。](https://moralis.io/how-to-connect-users-with-walletconnect/)

## 如何通过三个步骤使用 WalletConnect 对用户进行身份验证

既然我们已经回答了“什么是 WalletConnect？”并且更好地理解了为什么我们需要对我们的 dApp 用户进行身份验证，我们就可以进一步了解这个过程了。在本教程中，我们将创建一个简单的 dApp，专门用于认证用户。由于我们与 Moralis 合作，该流程变得简单明了，由以下三个步骤组成:

1.  初始化道德。
2.  创建一个 HTML 文件。
3.  添加逻辑。

创建这个简单的 dApp 只需要几分钟，因为我们将利用 Moralis 的特性。然而，当谈到 dApp 的 HTML 文件时，我们不会太深入，因为您将能够根据自己的喜好设计和构造内容。而且，逻辑会用 [JavaScript](https://moralis.io/javascript-explained-what-is-javascript/) 来写。因此，对这门语言有所了解将是有益的。尽管如此，如果你是一个新手，你可以跟随我们，因为我们会带你走过每一步。

如果你更想看一段由 Moralis 的专家解释过程的视频，请收听 Moralis YouTube 频道，下面的视频展示了这一过程:

https://www.youtube.com/watch?v=3Ij6wp0fuXw

### **步骤 1:如何通过 WalletConnect 验证用户身份–初始化道德标准**

为了初始化 Moralis，我们需要一个服务器。因此，如果你还没有，你需要做的第一件事就是注册道德。一旦你有一个帐户并登录，你可以继续点击“+创建一个新的服务器”按钮在你的管理面板顶部。

点击此按钮将提供三种不同的选择。您在这里选择的选项应该基于您要部署 dApp 的位置。但是，单击任一选项都会将您带到一个新窗口来输入一些信息。首先，我们需要给服务器一个名称。其次，我们需要选择一个地区，最后，我们还需要选择网络。

![](img/77f5951971fec263c755250213b901ac.png)

一旦完成，剩下的就是点击窗口右下角的“添加实例”按钮。启动服务器可能需要一段时间，但该过程将很快完成。

![](img/2ae7beeebe4a78183316fbdf45644222.png)

实例启动并运行后，我们可以单击相关服务器的“查看详细信息”按钮。在可用信息中，您将找到服务器 URL 和应用程序 ID。现在，有了这些信息，您可以继续创建一个 JavaScript 文件。在该文件中，您将使用先前获取的信息并输入以下内容:

```js
Moralis.initialize("paste Moralis app ID here”);
Moralis.serverURL = "paste Moralis server URL here”;
```

这个初始步骤通常在用 Moralis 创建 dApps 时完成。因此，遵循相同的程序将有助于您开始任何未来的 dApp 项目。现在，服务器已经启动并运行了，我们可以继续深入研究 HTML 代码。

### **步骤 2:如何通过 WalletConnect 验证用户身份–创建一个 HTML 文件**

接下来，我们需要构建内容，并添加应用程序所需的字段和按钮。为了构建内容，我们将使用 HTML 代码，作为一个示例，这是用户界面(如视频教程所示)的外观:

![](img/6929cd9d8519cacdf483d1ce1d4e512d.png)![](img/41c448176d9d73d9bd96298c74d195ee.png)

正如你从上面的图片中看到的，我们最初只有一个登录按钮。用户登录后，会出现“注销”或“测试签名”的附加选项。因此，我们需要将这些按钮添加到 HTML 代码中。下面是登录按钮的代码示例:

```js
<button id=”btn-auth">Login</button>
```

然而，这只是一个简单的演示 dApp，一个网站通常会有额外的元素。因此，您可以根据自己的喜好来组织内容。出于这个原因，我们不会深入研究这个文件。不过，不用担心；如果你想要灵感，想要更仔细地查看完整的文件，那么你可以访问 GitHub 资源库的以下页面:“[index.html](https://github.com/MoralisWeb3/demo-apps/blob/main/walletconnect/index.html)”。

一旦您有了 dApp 所需的布局，我们就可以进入下一步，这涉及到这个简单应用程序的逻辑。这也是我们添加允许我们使用 WalletConnect 认证用户的功能的地方。

### **步骤 3:如何使用 WalletConnect 验证用户身份–添加逻辑**

随着服务器的启动和运行，以及 web 应用程序内容的适当结构，我们可以添加一些逻辑。我们将要创建的 dApp 包含五个不同的函数:

1.  renderApp()
2.  认证()
3.  注销()
4.  测试呼叫()
5.  启用 Web3()

这些都是基本功能；但是，我们将重点关注“authenticate()”和“enableWeb3()”函数，因为这是我们需要添加逻辑的地方，以确保用户可以通过 WalletConnect 验证自己。

#### **authenticate()**

正如“authenticate()”函数的名称所示，它对用户进行身份验证。我们在这个函数中有“Moralis.authenticate()”函数，作为开发人员，它允许我们用一行代码对用户进行身份验证。

最初，这个函数使用元掩码验证用户，除非传递了一个参数。在这种情况下，我们希望使用 WalletConnect 对用户进行身份验证，这意味着我们需要输入一个提供者作为参数。在本例中，我们创建了一个“const ”,最初在 JavaScript 文件中用“walletconnect”对其赋值。然后，我们简单地使用这个“const”并在调用“Moralis.authenticate()”函数时将其作为参数传递。此外，在调用“Moralis.enableWeb3()”函数时，我们还将相同的“const”作为参数传递。因此，完整的函数如下所示:

```js
async function authenticate() {
 try {
  user = await Moralis.authenticate({ provider });
  web3 = await Moralis.enableWeb3({ provider });
 } catch (error) {
  console.log('authenticate failed', error);
 }
 renderApp();
}
```

#### **enableWeb3()**

接下来，我们还需要“enableWeb3()”函数来指定提供者。由于我们希望使用 WalletConnect 对用户进行身份验证，因此我们将再次使用相同的“const ”,并将其作为参数传递。因此，这个函数看起来是这样的:

```js
async function enableWeb3() {
 try {
  web3 = await Moralis.enableWeb3({ provider });
 } catch (error) {
  console.log('testCall failed', error);
 }
 renderApp();
}
```

这涵盖了使用 WalletConnect 对用户进行身份验证所需的步骤；然而，完整的 dApp 还有其他元素。如果你想看看其他功能以及它们如何通过点击事件连接到按钮，请查看 [Moralis GitHub 库](https://github.com/MoralisWeb3/demo-apps/tree/main/walletconnect)中的完整代码。

此外，您还可以仔细查看用于设计网站元素样式的 [CSS](https://moralis.io/cascading-style-sheets-what-is-css/) 文件。这个也可以根据自己的喜好来做；然而，当你创建 dApps 时，看一看可能会给你一些灵感。

## **总结–什么是 WalletConnect？**

WalletConnect 不是一个应用程序，而是一个在钱包和 dApps 之间建立安全和加密连接的协议。该协议提供了超过 75 种不同钱包的工作集成，元掩码是其中之一。因此，WalletConnect 提供了比简单使用加密钱包更高的安全性。

此外，还可以利用 WalletConnect 访问真正的 dApp 用户，这在使用 Moralis 时非常简单。作为操作系统的用户，可以用一行代码对用户进行身份验证。此外，在本文中，我们能够在几分钟内通过三个简单的步骤创建一个演示 dApp。这展示了与道德家合作的潜力。然而，这远远不是道德的限制，因为它可以在各种不同的区块链项目中使用。例如，你可以利用该系统[开发你自己的 NFT 市场](https://moralis.io/develop-your-own-nft-marketplace-step-by-step-guide/)，[建立你的第一个 dApp](https://moralis.io/build-your-first-dapp-ethereum-tutorial/) ，[创建一个 DeFi 仪表板](https://moralis.io/how-to-create-a-defi-dashboard-in-5-steps/)，等等。

该平台还提供了额外的优秀开发工具，如对 [IPFS](https://moralis.io/what-is-ipfs-interplanetary-file-system/) 、[道德利斯 NFT API](https://moralis.io/announcing-the-moralis-nft-api/) 、[价格 API](https://moralis.io/introducing-the-moralis-price-api/) 等的原生支持。此外，如果你想了解更多关于区块链行业的总体情况，请访问 [Moralis 博客](https://moralis.io/blog/?utm_source=blog&utm_medium=post&utm_campaign=Introducing%2520the%2520Moralis%2520Price%2520API)获取新鲜刺激的内容，让你了解最新动态。在那里，你一定会找到一切，从全面的[以太坊测试网](https://moralis.io/ethereum-testnet-guide-connect-to-ethereum-testnets/)指南，到分解的 [OpenZeppelin](https://moralis.io/what-is-openzeppelin-the-ultimate-guide/) 、 [BEP20](https://moralis.io/what-is-bep20-full-binance-smart-chain-token-guide/) 、 [ERC721](https://moralis.io/erc-721-token-standard-how-to-transfer-erc721-tokens/) 、 [ERC1155](https://moralis.io/erc1155-exploring-the-erc-1155-token-standard/) 等等！

所以，如果你想成为一名区块链开发者，第一步就是和道德家签约。这将为您提供无限可扩展的后端基础设施，让您快速开发 dApps！